CREATE DATABASE MALLAFICCT;

USE MALLAFICCT;

CREATE TABLE DOCENTE
(
	CODIGO INTEGER NOT NULL PRIMARY KEY,
    NOMBRE VARCHAR(50) NOT NULL
);

CREATE TABLE MATERIA 
(
	SIGLA VARCHAR(6) NOT NULL PRIMARY KEY,
    NOMBRE VARCHAR(50) NOT NULL
);

CREATE TABLE HORARIO
(
	ID INTEGER NOT NULL PRIMARY KEY,
    DIA VARCHAR(50) NOT NULL,
    HORAI TIME NOT NULL,
    HORAF TIME NOT NULL
);


CREATE TABLE GRUPO 
(
	ID INTEGER NOT NULL PRIMARY KEY,
    NOMBRE VARCHAR(2) NOT NULL,
    CODIGO INTEGER NOT NULL,
    SIGLA VARCHAR(6) NOT NULL,
    FOREIGN KEY (CODIGO)
		REFERENCES DOCENTE(CODIGO)
        ON UPDATE CASCADE
        ON DELETE CASCADE,
	FOREIGN KEY(SIGLA) 
		REFERENCES MATERIA(SIGLA)
        ON UPDATE CASCADE
        ON DELETE CASCADE
);

CREATE TABLE TIENE
(
	IDGRUPO INTEGER NOT NULL,
    IDHORARIO INTEGER NOT NULL,
    PRIMARY KEY(IDGRUPO, IDHORARIO),
    FOREIGN KEY(IDGRUPO) 
		REFERENCES GRUPO(ID)
        ON UPDATE CASCADE
        ON DELETE CASCADE,
	FOREIGN KEY(IDHORARIO)
		REFERENCES HORARIO(ID)
		ON UPDATE CASCADE
        ON DELETE CASCADE
);

INSERT INTO DOCENTE(CODIGO, NOMBRE) VALUES(111, 'ZUNA VILLAGOMEZ RICARDO');
INSERT INTO DOCENTE(CODIGO, NOMBRE) VALUES(222, 'VEIZAGA GONZALES JOSUE');
INSERT INTO DOCENTE(CODIGO, NOMBRE) VALUES(333, 'CONTRERAS VILLEGAS JUAN CARLOS');

INSERT INTO MATERIA(SIGLA, NOMBRE) VALUES('INF110', 'INTRODUCCION A LA INFORMATICA');
INSERT INTO MATERIA(SIGLA, NOMBRE) VALUES('INF312', 'BASE DE DATOS 1');

INSERT INTO HORARIO(ID, DIA, HORAI, HORAF) VALUES(1, 'LUN', '07:00', '08:30');
INSERT INTO HORARIO(ID, DIA, HORAI, HORAF) VALUES(2, 'LUN', '08:30', '10:00');
INSERT INTO HORARIO(ID, DIA, HORAI, HORAF) VALUES(3, 'LUN', '10:00', '11:30');
INSERT INTO HORARIO(ID, DIA, HORAI, HORAF) VALUES(4, 'MIE', '07:00', '08:30');
INSERT INTO HORARIO(ID, DIA, HORAI, HORAF) VALUES(5, 'MIE', '08:30', '10:00');
INSERT INTO HORARIO(ID, DIA, HORAI, HORAF) VALUES(6, 'MIE', '10:00', '11:30');
INSERT INTO HORARIO(ID, DIA, HORAI, HORAF) VALUES(7, 'VIE', '08:30', '10:00');
INSERT INTO HORARIO(ID, DIA, HORAI, HORAF) VALUES(8, 'VIE', '08:30', '10:30');
INSERT INTO HORARIO(ID, DIA, HORAI, HORAF) VALUES(9, 'VIE', '10:00', '11:30');

INSERT INTO GRUPO(ID, NOMBRE, CODIGO, SIGLA) VALUES(
	100, 'SB', 111, 'INF110'
);

INSERT INTO GRUPO(ID, NOMBRE, CODIGO, SIGLA) VALUES(
	101, 'SZ', 333, 'INF110'
);

INSERT INTO GRUPO(ID, NOMBRE, CODIGO, SIGLA) VALUES(
	102, 'SA', 222, 'INF312'
);

INSERT INTO TIENE(IDGRUPO, IDHORARIO) VALUES(
	100, 3
);
INSERT INTO TIENE(IDGRUPO, IDHORARIO) VALUES(
	100, 6
);
INSERT INTO TIENE(IDGRUPO, IDHORARIO) VALUES(
	100, 9
);
INSERT INTO TIENE(IDGRUPO, IDHORARIO) VALUES(
	101, 1
);
INSERT INTO TIENE(IDGRUPO, IDHORARIO) VALUES(
	101, 4
);
INSERT INTO TIENE(IDGRUPO, IDHORARIO) VALUES(
	100, 7
);
INSERT INTO TIENE(IDGRUPO, IDHORARIO) VALUES(
	102, 2
);
INSERT INTO TIENE(IDGRUPO, IDHORARIO) VALUES(
	102, 5
);
INSERT INTO TIENE(IDGRUPO, IDHORARIO) VALUES(
	102, 8
);

-- Mostrar las materias y grupos dictadas por ZUNA VILLAGOMEZ RICARDO */
SELECT MATERIA.NOMBRE, GRUPO.SIGLA
FROM MATERIA, DOCENTE, GRUPO
WHERE DOCENTE.CODIGO = GRUPO.CODIGO
AND GRUPO.SIGLA = MATERIA.SIGLA
AND DOCENTE.NOMBRE = "ZUNA VILLAGOMEZ RICARDO";

-- Mostrar cuantos grupos enseña ZUNA VILLAGOMEZ RICARDO
SELECT COUNT(*)
FROM GRUPO, DOCENTE
WHERE DOCENTE.CODIGO = GRUPO.CODIGO
AND DOCENTE.NOMBRE = "ZUNA VILLAGOMEZ RICARDO";

-- Mostrar el codigo y nombre de los docentes que enseñan introduccion a la informatica
SELECT DOCENTE.CODIGO , DOCENTE.NOMBRE
FROM DOCENTE, GRUPO, MATERIA
WHERE DOCENTE.CODIGO = GRUPO.CODIGO
AND GRUPO.SIGLA = MATERIA.SIGLA
AND MATERIA.NOMBRE = 'INTRODUCCION A LA INFORMATICA';

-- Mostrar el codigo y el nombre de los docentes, que señan los dias lunes a las 7:00
SELECT DOCENTE.CODIGO, DOCENTE.NOMBRE
FROM DOCENTE, GRUPO, HORARIO, TIENE
WHERE DOCENTE.CODIGO = GRUPO.CODIGO
AND GRUPO.ID = TIENE.IDGRUPO
AND TIENE.IDHORARIO = HORARIO.ID 
AND HORARIO.DIA = 'LUN'
AND HORARIO.HORAI = '07:00';

-- Mostrar el horario de clases de la materia de base de datos 1, del grupo SA
SELECT HORARIO.DIA, HORARIO.HORAI, HORARIO.HORAF
FROM HORARIO, MATERIA, GRUPO, TIENE
WHERE MATERIA.SIGLA = GRUPO.SIGLA
AND GRUPO.ID = TIENE.IDGRUPO
AND TIENE.IDHORARIO = HORARIO.ID
AND GRUPO.NOMBRE = 'SA'
AND MATERIA.NOMBRE = 'BASE DE DATOS 1';

-- con alias
SELECT H.DIA, H.HORAI, H.HORAF
FROM HORARIO H, MATERIA M, GRUPO G, TIENE T
WHERE M.SIGLA = G.SIGLA
AND G.ID = T.IDGRUPO
AND T.IDHORARIO = H.ID
AND G.NOMBRE = 'SA'
AND M.NOMBRE = 'BASE DE DATOS 1';

-- primer parcial va a ser miercoles 23 
-- no se puede llevar nuestras propias maquinas sino usar la del laboratorio
-- carnet de identidad
